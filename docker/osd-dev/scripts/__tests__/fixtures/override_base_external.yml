services:
  dashboard-src-installer:
    volumes:
      - '${SRC_DASHBOARD}:/home/node/kbn'
  osd:
    depends_on:
      dashboard-src-installer:
        condition: service_completed_successfully
    image: node:${NODE_VERSION}
    profiles:
      - 'dashboard-src'
    entrypoint: ['/bin/bash', '/entrypoint.sh']
    working_dir: /home/node/kbn
    tmpfs:
      - /home/node/kbn/data/wazuh/downloads:uid=1000,gid=1000,mode=0775
    volumes:
      - '${SRC_DASHBOARD}:/home/node/kbn'
      - '${SRC_SECURITY_PLUGIN}:/home/node/kbn/plugins/wazuh-security-dashboards-plugin'
      - ./dashboard-src/entrypoint.sh:/entrypoint.sh:ro
      - 'external-test:/home/node/kbn/plugins/external-test'
volumes:
  external-test:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: ${externalRepo}
